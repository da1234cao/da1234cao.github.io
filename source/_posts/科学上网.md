---
title: 搭建v2ray服务以科学上网
date: 2021-10-30 19:52
categories: 
- 杂项知识点
tags:
- v2ray
excerpt: 搭建v2ray服务以科学上网
---

# 了解背景

[翻墙软件VPN推荐，中国仅2款好用](https://github.com/vpncn/vpncn.github.io)、[2021便宜好用的VPS推荐，美国香港VPS避坑攻略](https://vpsda.github.io/)、[gcorelabs服务商](https://gcorelabs.com/about/)

我使用[vultr](https://www.vultr.com/zh/)。按小时收费的。如果开出一台服务器的ip是被屏蔽的，重新开一台就好。

# 配置主机

[ssh服务配置](https://blog.csdn.net/sinat_38816924/article/details/120561158)

# v2ray

## v2ray服务器端搭建

[V2Ray一键安装脚本](https://github.com/233boy/v2ray/wiki/V2Ray%E4%B8%80%E9%94%AE%E5%AE%89%E8%A3%85%E8%84%9A%E6%9C%AC)

## v2ray客户端安装

ref: [v2ray客户端-列表](https://www.v2ray.com/awesome/tools.html)

windows: v2rayN

linux: [v2raya](https://v2raya.org/docs/prologue/quick-start/)

安卓：[Kitsunebi](https://github.com/eycorsican/kitsunebi-android)

ipad：[Kitsunebi](https://apps.apple.com/us/app/kitsunebi-proxy-utility/id1446584073)

windows/linux：[Qv2ray](https://qv2ray.net/getting-started/) - 已不再维护

## v2ray问题处理

(ipv4+)端口被封，修复过程。

* ping 下 -- 可以ping通；ip没有被封
* 经测试，端口被封 -- 修改服务端口
* 登录服务器，输入`v2ray` 命令，根据提示修改端口，修改端口后重启服务
* 修改防火墙，放行上面端口
* 测试，仍然未通过。查看`/etc/v2ray/config.json`配置文件，发现修改端口的时候，协议从kcp转换为tcp。修改协议为kcp。重启服务
* 测试，通过。


## 使用tls

申请个免费域名：[freenom](https://www.freenom.com)

配置个tls：[v2ray-TLS](https://toutyrater.github.io/advanced/tls.html)

# xui

```shell
# 下载安装脚本
wget https://raw.githubusercontent.com/vaxilu/x-ui/master/install.sh

# 安装x-ui面板
sudo bash install.sh

# 设置开机自启
sudo x-ui enable
```

配置真的很简单。有UI，操作果然太舒服了。可以参考视频：[X-UI面板搭建教程](https://www.youtube.com/watch?v=peID0Nr41nc)

# 其他

* [IP端口可用性在线检测工具](https://www.toolsdaquan.com/ipcheck/)
* [Ubuntu20.04 防火墙设置](https://blog.csdn.net/cljdsc/article/details/120832554)
* [Linux 查看端口占用情况](https://www.runoob.com/w3cnote/linux-check-port-usage.html)
* [v2ray查看日志](https://github.com/233boy/v2ray/issues/631)